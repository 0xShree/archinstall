{
    "args" : {
        "password" : "<STDIN>",
        "user" : "anton",
        "_webbrowser" : "chromium",
        "_window_manager" : "awesome",
        "_keyboard_layout" : "sv-latin1"
    },
    "post" : {
        "Install workstation packages": {
            "pacman -Syy --noconfirm {_webbrowser} {_window_manager} openssh sshfs git dhclient ttf-freefont xorg-server xorg-xrandr xorg-xinit xterm nano wget pulseaudio pulseaudio-alsa pavucontrol smbclient cifs-utils xscreensaver" : null
        },
        "Enable autostarts": {
            "systemctl enable dhcpcd" : null
        },
        "Setup desktop environment" : {
            "sed -i 's/^twm &/#&/' /etc/X11/xinit/xinitrc" : null,
            "sed -i 's/^xclock/#&/' /etc/X11/xinit/xinitrc" : null,
            "sed -i 's/^xterm/#&/' /etc/X11/xinit/xinitrc" : null,
            "sed -i 's/^exec xterm/#&/' /etc/X11/xinit/xinitrc" : null,
            "sh -c \"echo 'setxkbmap se' >> /etc/X11/xinit/xinitrc\"" : null,
            "sh -c \"echo 'xscreensaver -no-splash &' >> /etc/X11/xinit/xinitrc\"" : null,
            "sh -c \"echo 'exec {_window_manager}' >> /etc/X11/xinit/xinitrc\"" : {"pass-args" : true},
            "sh -c \"echo 'KEYMAP={_keyboard_layout}\nFONT=lat9w-16' >> /etc/vconsole.conf\"" : {"pass-args" : true},
            "sh -c \"sed -i 's/{ \\\"open terminal\\\", terminal/{ \\\"Chromium\\\", \\\"chromium\\\" },\n     &1/' /etc/xdg/awesome/rc.lua\"" : null,
            "sh -c \"sed -i 's/{ \\\"open terminal\\\", terminal/{ \\\"File handler\\\", \\\"nemo\\\" },\n     &1/' /etc/xdg/awesome/rc.lua\"" : null,
            "sh -c \"sed -i 's/^globalkeys = gears.table.join(/&\n    awful.key({ modkey,    }, \\\"l\\\",  function() awful.spawn(\\\"xscreensaver-command -lock &\\\") end),\n/' /etc/xdg/awesome/rc.lua\"" : null,
            "sh -c \"awk -i inplace -v RS='' '{gsub(/awful.key\\({ modkey,.*?}, \\\"Tab\\\",.*?\\\"client\\\"}\\),/, \\\"awful.key({ modkey,      }, \\\"Tab\\\",\\\n      function ()\\\n        awful.client.focus.byidx(-1)\\\n        if client.focus then\\\n          client.focus:raise()\\\n        end\\\n      end),\\\n    awful.key({ modkey, \\\"Shift\\\"    }, \\\"Tab\\\",\\\n    function ()\\\n      awful.client.focus.byidx(1)\\\n        if client.focus then\\\n           client.focus.raise()\\\n        end\\\n      end),\\\"); print}' /etc/xdg/awesome/rc.lua\"" : null,
            "gsettings set org.nemo.desktop show-desktop-icons false" : null,
            "xdg-mime default nemo.desktop inode/directory application/x-gnome-saved-search" : null
        },
        "Setup users" : {
            "useradd -m -G wheel -s /bin/bash anton" : null,
            "sh -c \"echo {user}:{password} | chpasswd\"" : {"pass-args" : true}
        }
    }
}
